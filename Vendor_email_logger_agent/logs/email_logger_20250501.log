2025-05-01 00:47:23,447 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 00:47:23,453 - INFO - Loaded 1 vendor emails: ['mario904@snu.ac.kr']
2025-05-01 00:49:50,411 - INFO - "GET /?state=FQanAo9d6hFuWIXgm53nzIo3m3uZLL&code=4/0Ab_5qlmYF8TB_UwETumxtfca8433rCWGMtODE3soveA1BkQ7WeX5IU-QRYG4YOfMM5DlEw&scope=https://mail.google.com/ HTTP/1.1" 200 65
2025-05-01 00:49:50,705 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 00:49:51,120 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 00:49:51,191 - INFO - Supabase client initialized successfully
2025-05-01 00:49:51,192 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 00:49:54,715 - WARNING - Failed to parse date for msg 1968614074973d76: unconverted data remains:  (UTC)
2025-05-01 00:49:55,930 - WARNING - Failed to parse date for msg 196853f9d1bc1d2b: unconverted data remains:  (PDT)
2025-05-01 00:49:56,869 - WARNING - Failed to parse date for msg 19684a07992ee607: unconverted data remains:  (UTC)
2025-05-01 00:49:57,109 - WARNING - Failed to parse date for msg 196849e358ba9ffa: unconverted data remains:  (UTC)
2025-05-01 00:49:57,342 - WARNING - Failed to parse date for msg 196849e22242940e: unconverted data remains:  (UTC)
2025-05-01 00:49:58,599 - WARNING - Failed to parse date for msg 196829b3f1bb8ffb: unconverted data remains:  (UTC)
2025-05-01 00:49:58,831 - WARNING - Failed to parse date for msg 196829b392112b61: unconverted data remains:  (UTC)
2025-05-01 00:49:59,530 - WARNING - Failed to parse date for msg 1968242db3273e3b: unconverted data remains:  (UTC)
2025-05-01 00:50:01,051 - WARNING - Failed to parse date for msg 1968027a0d05a57e: unconverted data remains:  (PDT)
2025-05-01 00:50:04,551 - WARNING - Failed to parse date for msg 1967ae5d4b3feac0: unconverted data remains:  (UTC)
2025-05-01 00:50:08,413 - WARNING - Failed to parse date for msg 196729535825f65c: unconverted data remains:  (UTC)
2025-05-01 00:50:08,654 - WARNING - Failed to parse date for msg 19671ccc9c2b85fa: unconverted data remains:  (UTC)
2025-05-01 00:50:08,893 - WARNING - Failed to parse date for msg 196715605f3cebe6: unconverted data remains:  (UTC)
2025-05-01 00:50:09,630 - WARNING - Failed to parse date for msg 1966e5e6e2bea1f3: unconverted data remains:  (UTC)
2025-05-01 00:50:10,323 - WARNING - Failed to parse date for msg 1966c90a04da0476: unconverted data remains:  (UTC)
2025-05-01 00:50:10,783 - WARNING - Failed to parse date for msg 1966bd50e3313b4f: unconverted data remains:  (UTC)
2025-05-01 00:50:12,696 - WARNING - Failed to parse date for msg 19668c480a1ad604: unconverted data remains:  (UTC)
2025-05-01 00:50:12,927 - WARNING - Failed to parse date for msg 19668c2485dff58b: unconverted data remains:  (UTC)
2025-05-01 00:50:14,893 - WARNING - Failed to parse date for msg 19667b03cf6ec9a4: unconverted data remains:  (UTC)
2025-05-01 00:50:15,166 - WARNING - Failed to parse date for msg 19667a1aa8c5d141: unconverted data remains:  (UTC)
2025-05-01 00:50:15,398 - WARNING - Failed to parse date for msg 196671cb160698fa: unconverted data remains:  (+0000)
2025-05-01 00:50:15,634 - WARNING - Failed to parse date for msg 1966675e551856f8: unconverted data remains:  (UTC)
2025-05-01 00:50:16,386 - WARNING - Failed to parse date for msg 196651a274baee03: unconverted data remains:  (UTC)
2025-05-01 00:50:17,084 - WARNING - Failed to parse date for msg 19664c297b6cda37: unconverted data remains:  (UTC)
2025-05-01 00:50:20,165 - ERROR - Error collecting historical emails: can't compare offset-naive and offset-aware datetimes
2025-05-01 00:50:20,165 - INFO - GmailWatcher initialized
2025-05-01 01:11:19,639 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 01:11:19,640 - INFO - Loaded 1 vendor emails: ['mario904@snu.ac.kr']
2025-05-01 01:11:19,646 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 01:11:20,297 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 01:11:20,326 - INFO - Supabase client initialized successfully
2025-05-01 01:11:20,327 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 01:11:23,270 - WARNING - Failed to parse date for msg 1968614074973d76: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:24,505 - WARNING - Failed to parse date for msg 196853f9d1bc1d2b: unconverted data remains:  -0700 (PDT)
2025-05-01 01:11:25,463 - WARNING - Failed to parse date for msg 19684a07992ee607: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:25,709 - WARNING - Failed to parse date for msg 196849e358ba9ffa: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:25,945 - WARNING - Failed to parse date for msg 196849e22242940e: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:26,934 - WARNING - Failed to parse date for msg 196829b3f1bb8ffb: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:27,170 - WARNING - Failed to parse date for msg 196829b392112b61: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:28,201 - WARNING - Failed to parse date for msg 1968242db3273e3b: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:29,967 - WARNING - Failed to parse date for msg 1968027a0d05a57e: unconverted data remains:  -0700 (PDT)
2025-05-01 01:11:33,594 - WARNING - Failed to parse date for msg 1967ae5d4b3feac0: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:37,784 - WARNING - Failed to parse date for msg 196729535825f65c: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:38,028 - WARNING - Failed to parse date for msg 19671ccc9c2b85fa: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:38,258 - WARNING - Failed to parse date for msg 196715605f3cebe6: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:39,294 - WARNING - Failed to parse date for msg 1966e5e6e2bea1f3: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:40,012 - WARNING - Failed to parse date for msg 1966c90a04da0476: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:40,499 - WARNING - Failed to parse date for msg 1966bd50e3313b4f: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:42,480 - WARNING - Failed to parse date for msg 19668c480a1ad604: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:42,718 - WARNING - Failed to parse date for msg 19668c2485dff58b: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:44,432 - WARNING - Failed to parse date for msg 19667b03cf6ec9a4: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:44,673 - WARNING - Failed to parse date for msg 19667a1aa8c5d141: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:44,920 - WARNING - Failed to parse date for msg 196671cb160698fa: unconverted data remains:  +0000 (+0000)
2025-05-01 01:11:45,162 - WARNING - Failed to parse date for msg 1966675e551856f8: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:45,907 - WARNING - Failed to parse date for msg 196651a274baee03: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:46,627 - WARNING - Failed to parse date for msg 19664c297b6cda37: unconverted data remains:  +0000 (UTC)
2025-05-01 01:11:49,549 - ERROR - Error collecting historical emails: can't compare offset-naive and offset-aware datetimes
2025-05-01 01:11:49,549 - INFO - GmailWatcher initialized
2025-05-01 01:15:30,601 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 01:15:30,601 - INFO - Loaded 1 vendor emails: ['mario904@snu.ac.kr']
2025-05-01 01:15:30,606 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 01:15:31,166 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 01:15:31,192 - INFO - Supabase client initialized successfully
2025-05-01 01:15:31,193 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 01:15:34,351 - WARNING - Failed to parse date for msg 1968614074973d76: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:35,548 - WARNING - Failed to parse date for msg 196853f9d1bc1d2b: unconverted data remains:  -0700 (PDT)
2025-05-01 01:15:36,515 - WARNING - Failed to parse date for msg 19684a07992ee607: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:36,760 - WARNING - Failed to parse date for msg 196849e358ba9ffa: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:36,996 - WARNING - Failed to parse date for msg 196849e22242940e: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:37,978 - WARNING - Failed to parse date for msg 196829b3f1bb8ffb: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:38,514 - WARNING - Failed to parse date for msg 196829b392112b61: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:39,251 - WARNING - Failed to parse date for msg 1968242db3273e3b: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:40,714 - WARNING - Failed to parse date for msg 1968027a0d05a57e: unconverted data remains:  -0700 (PDT)
2025-05-01 01:15:44,349 - WARNING - Failed to parse date for msg 1967ae5d4b3feac0: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:48,531 - WARNING - Failed to parse date for msg 196729535825f65c: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:48,761 - WARNING - Failed to parse date for msg 19671ccc9c2b85fa: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:48,995 - WARNING - Failed to parse date for msg 196715605f3cebe6: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:49,715 - WARNING - Failed to parse date for msg 1966e5e6e2bea1f3: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:50,439 - WARNING - Failed to parse date for msg 1966c90a04da0476: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:50,925 - WARNING - Failed to parse date for msg 1966bd50e3313b4f: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:52,873 - WARNING - Failed to parse date for msg 19668c480a1ad604: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:53,110 - WARNING - Failed to parse date for msg 19668c2485dff58b: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:55,162 - WARNING - Failed to parse date for msg 19667b03cf6ec9a4: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:55,395 - WARNING - Failed to parse date for msg 19667a1aa8c5d141: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:55,646 - WARNING - Failed to parse date for msg 196671cb160698fa: unconverted data remains:  +0000 (GMT)
2025-05-01 01:15:55,905 - WARNING - Failed to parse date for msg 1966675e551856f8: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:56,622 - WARNING - Failed to parse date for msg 196651a274baee03: unconverted data remains:  +0000 (UTC)
2025-05-01 01:15:57,345 - WARNING - Failed to parse date for msg 19664c297b6cda37: unconverted data remains:  +0000 (UTC)
2025-05-01 01:16:09,225 - INFO - Is vendor: True
2025-05-01 01:16:11,430 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:11,436 - INFO - Generated email type: purchase order review
2025-05-01 01:16:32,646 - ERROR - Error downloading attachment: The read operation timed out
2025-05-01 01:16:32,647 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 01:16:33,050 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:16:33,058 - INFO - Found 0 emails in thread
2025-05-01 01:16:33,912 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:33,913 - INFO - Parsed delivery date: None
2025-05-01 01:16:33,915 - INFO - Attempting to save email log: new po
2025-05-01 01:16:33,959 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:16:33,961 - INFO - Email saved successfully: new po
2025-05-01 01:16:36,241 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:16:36,244 - INFO - Processed email: 1967aac700cf1999
2025-05-01 01:16:36,629 - INFO - Is vendor: True
2025-05-01 01:16:38,701 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:38,702 - INFO - Generated email type: delivery delay
2025-05-01 01:16:38,703 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 01:16:38,734 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:16:38,736 - INFO - Found 0 emails in thread
2025-05-01 01:16:39,471 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:39,475 - INFO - Parsed delivery date: None
2025-05-01 01:16:39,476 - INFO - Attempting to save email log: po status update
2025-05-01 01:16:39,526 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:16:39,528 - INFO - Email saved successfully: po status update
2025-05-01 01:16:41,832 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:16:41,832 - INFO - Processed email: 1967ab19c3293811
2025-05-01 01:16:42,802 - INFO - Is vendor: True
2025-05-01 01:16:45,035 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:45,036 - INFO - Generated email type: delivery confirmation
2025-05-01 01:16:45,036 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 01:16:45,216 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:16:45,217 - INFO - Found 0 emails in thread
2025-05-01 01:16:46,224 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:46,229 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:16:46,229 - INFO - Attempting to save email log: 
2025-05-01 01:16:46,283 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:16:46,285 - INFO - Email saved successfully: 
2025-05-01 01:16:48,583 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:16:48,583 - INFO - Processed email: 1967b271a1c91212
2025-05-01 01:16:48,827 - INFO - Is vendor: True
2025-05-01 01:16:51,888 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:51,890 - INFO - Generated email type: delivery confirmation
2025-05-01 01:16:51,890 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 01:16:52,031 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:16:52,033 - INFO - Found 0 emails in thread
2025-05-01 01:16:52,949 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:16:52,954 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:16:52,954 - INFO - Attempting to save email log: 
2025-05-01 01:16:52,996 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:16:52,997 - INFO - Email saved successfully: 
2025-05-01 01:16:55,297 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:16:55,298 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 01:17:02,519 - INFO - Is vendor: True
2025-05-01 01:17:04,792 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:04,800 - INFO - Generated email type: purchase order
2025-05-01 01:17:04,801 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 01:17:04,881 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:17:04,884 - INFO - Found 0 emails in thread
2025-05-01 01:17:06,121 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:06,125 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:17:06,125 - INFO - Attempting to save email log: 
2025-05-01 01:17:06,166 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:17:06,169 - INFO - Email saved successfully: 
2025-05-01 01:17:08,481 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:17:08,483 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 01:17:08,724 - INFO - Is vendor: True
2025-05-01 01:17:10,831 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:10,832 - INFO - Generated email type: shipment scheduling
2025-05-01 01:17:10,833 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 01:17:10,878 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:17:10,882 - INFO - Found 0 emails in thread
2025-05-01 01:17:11,748 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:11,750 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 01:17:11,750 - INFO - Attempting to save email log: eta alert
2025-05-01 01:17:11,784 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:17:11,785 - INFO - Email saved successfully: eta alert
2025-05-01 01:17:14,085 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:17:14,087 - INFO - Processed email: 19685655410ff470
2025-05-01 01:17:14,348 - INFO - Is vendor: True
2025-05-01 01:17:16,373 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:16,379 - INFO - Generated email type: delivery delay
2025-05-01 01:17:16,380 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 01:17:16,426 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:17:16,435 - INFO - Found 0 emails in thread
2025-05-01 01:17:17,212 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:17,214 - INFO - Parsed delivery date: None
2025-05-01 01:17:17,214 - INFO - Attempting to save email log: new eta for the latest po
2025-05-01 01:17:17,251 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:17:17,252 - INFO - Email saved successfully: new eta for the latest po
2025-05-01 01:17:19,554 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:17:19,554 - INFO - Processed email: 196858d50560d69c
2025-05-01 01:17:19,791 - INFO - Is vendor: True
2025-05-01 01:17:22,098 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:22,100 - INFO - Generated email type: delivery delay
2025-05-01 01:17:22,101 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 01:17:22,147 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:17:22,150 - INFO - Found 0 emails in thread
2025-05-01 01:17:23,027 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:17:23,029 - INFO - Parsed delivery date: None
2025-05-01 01:17:23,029 - INFO - Attempting to save email log: delay alert for the latest po
2025-05-01 01:17:23,069 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:17:23,070 - INFO - Email saved successfully: delay alert for the latest po
2025-05-01 01:17:25,363 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:17:25,364 - INFO - Processed email: 196858fe40e734ea
2025-05-01 01:17:34,540 - INFO - GmailWatcher initialized
2025-05-01 01:18:14,715 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 01:18:14,716 - INFO - Loaded 1 vendor emails: ['mario904@snu.ac.kr']
2025-05-01 01:18:14,720 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 01:18:15,006 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 01:18:15,040 - INFO - Supabase client initialized successfully
2025-05-01 01:18:15,041 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 01:18:18,476 - WARNING - Failed to parse date for msg 1968614074973d76: unconverted data remains:  \1
2025-05-01 01:18:19,688 - WARNING - Failed to parse date for msg 196853f9d1bc1d2b: unconverted data remains:  \1
2025-05-01 01:18:20,652 - WARNING - Failed to parse date for msg 19684a07992ee607: unconverted data remains:  \1
2025-05-01 01:18:20,898 - WARNING - Failed to parse date for msg 196849e358ba9ffa: unconverted data remains:  \1
2025-05-01 01:18:21,135 - WARNING - Failed to parse date for msg 196849e22242940e: unconverted data remains:  \1
2025-05-01 01:18:22,119 - WARNING - Failed to parse date for msg 196829b3f1bb8ffb: unconverted data remains:  \1
2025-05-01 01:18:22,359 - WARNING - Failed to parse date for msg 196829b392112b61: unconverted data remains:  \1
2025-05-01 01:18:23,071 - WARNING - Failed to parse date for msg 1968242db3273e3b: unconverted data remains:  \1
2025-05-01 01:18:24,501 - WARNING - Failed to parse date for msg 1968027a0d05a57e: unconverted data remains:  \1
2025-05-01 01:18:28,410 - WARNING - Failed to parse date for msg 1967ae5d4b3feac0: unconverted data remains:  \1
2025-05-01 01:18:32,605 - WARNING - Failed to parse date for msg 196729535825f65c: unconverted data remains:  \1
2025-05-01 01:18:32,850 - WARNING - Failed to parse date for msg 19671ccc9c2b85fa: unconverted data remains:  \1
2025-05-01 01:18:33,085 - WARNING - Failed to parse date for msg 196715605f3cebe6: unconverted data remains:  \1
2025-05-01 01:18:33,794 - WARNING - Failed to parse date for msg 1966e5e6e2bea1f3: unconverted data remains:  \1
2025-05-01 01:18:34,521 - WARNING - Failed to parse date for msg 1966c90a04da0476: unconverted data remains:  \1
2025-05-01 01:18:34,990 - WARNING - Failed to parse date for msg 1966bd50e3313b4f: unconverted data remains:  \1
2025-05-01 01:18:36,934 - WARNING - Failed to parse date for msg 19668c480a1ad604: unconverted data remains:  \1
2025-05-01 01:18:37,170 - WARNING - Failed to parse date for msg 19668c2485dff58b: unconverted data remains:  \1
2025-05-01 01:18:38,824 - WARNING - Failed to parse date for msg 19667b03cf6ec9a4: unconverted data remains:  \1
2025-05-01 01:18:39,062 - WARNING - Failed to parse date for msg 19667a1aa8c5d141: unconverted data remains:  \1
2025-05-01 01:18:39,298 - WARNING - Failed to parse date for msg 196671cb160698fa: unconverted data remains:  \1
2025-05-01 01:18:39,538 - WARNING - Failed to parse date for msg 1966675e551856f8: unconverted data remains:  \1
2025-05-01 01:18:40,278 - WARNING - Failed to parse date for msg 196651a274baee03: unconverted data remains:  \1
2025-05-01 01:20:36,402 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 01:20:36,403 - INFO - Loaded 1 vendor emails: ['mario904@snu.ac.kr']
2025-05-01 01:20:36,410 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 01:20:36,683 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 01:20:36,720 - INFO - Supabase client initialized successfully
2025-05-01 01:20:36,721 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 01:21:19,985 - INFO - Is vendor: True
2025-05-01 01:21:22,448 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:22,452 - INFO - Generated email type: order review
2025-05-01 01:21:23,592 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 01:21:23,593 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 01:21:23,594 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 01:21:23,707 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:21:23,710 - INFO - Found 1 emails in thread
2025-05-01 01:21:24,372 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:24,382 - INFO - Parsed delivery date: None
2025-05-01 01:21:24,383 - INFO - Attempting to save email log: new po
2025-05-01 01:21:24,415 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:21:24,418 - INFO - Email saved successfully: new po
2025-05-01 01:21:26,706 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:21:26,707 - INFO - Processed email: 1967aac700cf1999
2025-05-01 01:21:26,930 - INFO - Is vendor: True
2025-05-01 01:21:29,420 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:29,423 - INFO - Generated email type: delivery delay
2025-05-01 01:21:29,424 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 01:21:29,537 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:21:29,538 - INFO - Found 1 emails in thread
2025-05-01 01:21:30,157 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:30,165 - INFO - Parsed delivery date: None
2025-05-01 01:21:30,166 - INFO - Attempting to save email log: po status update
2025-05-01 01:21:30,200 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:21:30,201 - INFO - Email saved successfully: po status update
2025-05-01 01:21:32,487 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:21:32,487 - INFO - Processed email: 1967ab19c3293811
2025-05-01 01:21:33,658 - INFO - Is vendor: True
2025-05-01 01:21:35,882 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:35,889 - INFO - Generated email type: delivery confirmation
2025-05-01 01:21:35,889 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 01:21:35,974 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:21:35,977 - INFO - Found 1 emails in thread
2025-05-01 01:21:37,558 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:37,562 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:21:37,562 - INFO - Attempting to save email log: 
2025-05-01 01:21:37,592 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:21:37,594 - INFO - Email saved successfully: 
2025-05-01 01:21:39,905 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:21:39,907 - INFO - Processed email: 1967b271a1c91212
2025-05-01 01:21:40,151 - INFO - Is vendor: True
2025-05-01 01:21:42,777 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:42,781 - INFO - Generated email type: delivery confirmation
2025-05-01 01:21:42,782 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 01:21:42,886 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:21:42,887 - INFO - Found 1 emails in thread
2025-05-01 01:21:43,988 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:43,991 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:21:43,991 - INFO - Attempting to save email log: 
2025-05-01 01:21:44,027 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:21:44,029 - INFO - Email saved successfully: 
2025-05-01 01:21:46,334 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:21:46,335 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 01:21:55,602 - INFO - Is vendor: True
2025-05-01 01:21:57,860 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:57,862 - INFO - Generated email type: order confirmation
2025-05-01 01:21:57,863 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 01:21:57,974 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:21:57,976 - INFO - Found 1 emails in thread
2025-05-01 01:21:59,109 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:21:59,114 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 01:21:59,116 - INFO - Attempting to save email log: 
2025-05-01 01:21:59,175 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:21:59,176 - INFO - Email saved successfully: 
2025-05-01 01:22:01,477 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:22:01,478 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 01:22:01,949 - INFO - Is vendor: True
2025-05-01 01:22:05,204 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:05,211 - INFO - Generated email type: shipment scheduling
2025-05-01 01:22:05,212 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 01:22:05,361 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:22:05,365 - INFO - Found 1 emails in thread
2025-05-01 01:22:06,562 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:06,565 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 01:22:06,566 - INFO - Attempting to save email log: eta alert
2025-05-01 01:22:06,619 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:22:06,621 - INFO - Email saved successfully: eta alert
2025-05-01 01:22:08,916 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:22:08,917 - INFO - Processed email: 19685655410ff470
2025-05-01 01:22:09,196 - INFO - Is vendor: True
2025-05-01 01:22:11,529 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:11,533 - INFO - Generated email type: delivery delay
2025-05-01 01:22:11,533 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 01:22:11,566 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:22:11,571 - INFO - Found 1 emails in thread
2025-05-01 01:22:12,523 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:12,526 - INFO - Parsed delivery date: None
2025-05-01 01:22:12,526 - INFO - Attempting to save email log: new eta for the latest po
2025-05-01 01:22:12,578 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:22:12,579 - INFO - Email saved successfully: new eta for the latest po
2025-05-01 01:22:14,880 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:22:14,881 - INFO - Processed email: 196858d50560d69c
2025-05-01 01:22:15,114 - INFO - Is vendor: True
2025-05-01 01:22:17,504 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:17,506 - INFO - Generated email type: delivery delay
2025-05-01 01:22:17,507 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 01:22:17,559 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:22:17,563 - INFO - Found 1 emails in thread
2025-05-01 01:22:18,925 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:22:18,927 - INFO - Parsed delivery date: None
2025-05-01 01:22:18,928 - INFO - Attempting to save email log: delay alert for the latest po
2025-05-01 01:22:18,973 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:22:18,976 - INFO - Email saved successfully: delay alert for the latest po
2025-05-01 01:22:21,278 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:22:21,279 - INFO - Processed email: 196858fe40e734ea
2025-05-01 01:22:24,754 - INFO - GmailWatcher initialized
2025-05-01 01:24:09,706 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000015E16A4C730>
2025-05-01 01:24:25,228 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 01:24:25,229 - INFO - Loaded 1 vendor emails: ['news4sungho@gmail.com']
2025-05-01 01:24:25,238 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 01:24:25,534 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 01:24:25,572 - INFO - Supabase client initialized successfully
2025-05-01 01:24:25,574 - INFO - Searching emails with query: after:2025/03/31
2025-05-01 01:25:20,096 - INFO - Is vendor: True
2025-05-01 01:25:22,610 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:22,617 - INFO - Generated email type: purchase order confirmation
2025-05-01 01:25:23,862 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 01:25:23,865 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 01:25:23,866 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 01:25:23,992 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:25:24,002 - INFO - Found 0 emails in thread
2025-05-01 01:25:24,847 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:24,850 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 01:25:24,851 - INFO - Attempting to save email log: PO for 100ml cosmetic containers
2025-05-01 01:25:24,895 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:25:24,897 - INFO - Email saved successfully: PO for 100ml cosmetic containers
2025-05-01 01:25:27,204 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:25:27,205 - INFO - Processed email: 19687301aeba3f47
2025-05-01 01:25:27,686 - INFO - Is vendor: True
2025-05-01 01:25:30,290 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:30,292 - INFO - Generated email type: shipment confirmation
2025-05-01 01:25:30,292 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 01:25:30,386 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:25:30,389 - INFO - Found 1 emails in thread
2025-05-01 01:25:31,304 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:31,306 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 01:25:31,306 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:31,352 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:25:31,357 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:33,665 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:25:33,665 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 01:25:33,894 - INFO - Is vendor: True
2025-05-01 01:25:36,803 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:36,805 - INFO - Generated email type: delivery delay
2025-05-01 01:25:36,805 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 01:25:36,899 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:25:36,901 - INFO - Found 2 emails in thread
2025-05-01 01:25:37,730 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:37,731 - INFO - Parsed delivery date: 2023-05-09
2025-05-01 01:25:37,731 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:37,769 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:25:37,770 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:40,079 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:25:40,081 - INFO - Processed email: 196873410fd5bbde
2025-05-01 01:25:40,321 - INFO - Is vendor: True
2025-05-01 01:25:43,809 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:43,811 - INFO - Generated email type: shipment confirmation
2025-05-01 01:25:43,811 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 01:25:43,899 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 01:25:43,901 - INFO - Found 3 emails in thread
2025-05-01 01:25:44,860 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 01:25:44,864 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 01:25:44,865 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:44,894 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 01:25:44,899 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 01:25:47,190 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 01:25:47,190 - INFO - Processed email: 19687342396240ae
2025-05-01 01:25:47,676 - INFO - GmailWatcher initialized
2025-05-01 01:25:48,647 - INFO - Is vendor: True
2025-05-01 01:37:30,562 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001DEC8C19F30>
2025-05-01 15:15:54,450 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 15:15:54,453 - INFO - Loaded 1 vendor emails: ['news4sungho@gmail.com']
2025-05-01 15:15:54,463 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 15:15:54,700 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 15:15:54,726 - INFO - Supabase client initialized successfully
2025-05-01 15:15:54,727 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 15:16:54,495 - INFO - Is vendor: True
2025-05-01 15:16:57,079 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:16:57,081 - INFO - Generated email type: purchase order
2025-05-01 15:16:57,874 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 15:16:57,877 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 15:16:57,878 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:16:58,022 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:16:58,030 - INFO - Found 0 emails in thread
2025-05-01 15:16:58,790 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:16:58,798 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 15:16:58,799 - INFO - Attempting to save email log: PO for 100ml cosmetic containers
2025-05-01 15:16:58,876 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:16:58,877 - INFO - Email saved successfully: PO for 100ml cosmetic containers
2025-05-01 15:17:01,203 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 15:17:01,204 - INFO - Processed email: 19687301aeba3f47
2025-05-01 15:17:01,662 - INFO - Is vendor: True
2025-05-01 15:17:03,752 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:03,755 - INFO - Generated email type: shipment confirmation
2025-05-01 15:17:03,755 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:17:03,807 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:17:03,807 - INFO - Found 1 emails in thread
2025-05-01 15:17:04,643 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:04,647 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 15:17:04,647 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:04,697 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:17:04,698 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:07,003 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 15:17:07,003 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 15:17:07,235 - INFO - Is vendor: True
2025-05-01 15:17:09,642 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:09,653 - INFO - Generated email type: delivery delay
2025-05-01 15:17:09,653 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:17:09,702 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:17:09,705 - INFO - Found 2 emails in thread
2025-05-01 15:17:10,574 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:10,577 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 15:17:10,578 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:10,628 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:17:10,630 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:12,947 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 15:17:12,948 - INFO - Processed email: 196873410fd5bbde
2025-05-01 15:17:13,192 - INFO - Is vendor: True
2025-05-01 15:17:15,265 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:15,268 - INFO - Generated email type: shipment confirmation
2025-05-01 15:17:15,268 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:17:15,320 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:17:15,322 - INFO - Found 3 emails in thread
2025-05-01 15:17:16,156 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:17:16,158 - INFO - Parsed delivery date: 2025-05-07
2025-05-01 15:17:16,158 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:16,200 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:17:16,201 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:17:18,487 - ERROR - Error sending message to MCP server: Cannot connect to host localhost:8000 ssl:default [원격 컴퓨터가 네트워크 연결을 거부했습니다]
2025-05-01 15:17:18,488 - INFO - Processed email: 19687342396240ae
2025-05-01 15:17:20,091 - INFO - GmailWatcher initialized
2025-05-01 15:17:22,576 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001DBC3BBAB60>
2025-05-01 15:18:08,486 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 15:18:08,487 - INFO - Loaded 1 vendor emails: ['news4sungho@gmail.com']
2025-05-01 15:18:08,492 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 15:18:08,686 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 15:18:08,710 - INFO - Supabase client initialized successfully
2025-05-01 15:18:08,711 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 15:19:04,513 - INFO - Is vendor: True
2025-05-01 15:19:06,586 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:06,589 - INFO - Generated email type: purchase order
2025-05-01 15:19:07,399 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 15:19:07,400 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 15:19:07,400 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:19:07,507 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:19:07,511 - INFO - Found 0 emails in thread
2025-05-01 15:19:08,581 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:08,587 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 15:19:08,589 - INFO - Attempting to save email log: PO for 100ml cosmetic containers
2025-05-01 15:19:08,629 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:19:08,630 - INFO - Email saved successfully: PO for 100ml cosmetic containers
2025-05-01 15:19:08,924 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 15:19:08,925 - INFO - Processed email: 19687301aeba3f47
2025-05-01 15:19:09,399 - INFO - Is vendor: True
2025-05-01 15:19:11,645 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:11,648 - INFO - Generated email type: shipment confirmation
2025-05-01 15:19:11,649 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:19:11,684 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:19:11,686 - INFO - Found 1 emails in thread
2025-05-01 15:19:12,547 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:12,556 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 15:19:12,556 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:12,589 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:19:12,591 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:12,593 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:12,594 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 15:19:12,825 - INFO - Is vendor: True
2025-05-01 15:19:14,764 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:14,767 - INFO - Generated email type: delivery delay
2025-05-01 15:19:14,767 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:19:14,807 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:19:14,810 - INFO - Found 2 emails in thread
2025-05-01 15:19:15,517 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:15,520 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 15:19:15,521 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:15,559 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:19:15,563 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:15,822 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:15,822 - INFO - Processed email: 196873410fd5bbde
2025-05-01 15:19:16,045 - INFO - Is vendor: True
2025-05-01 15:19:17,975 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:17,985 - INFO - Generated email type: shipment confirmation
2025-05-01 15:19:17,987 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 15:19:18,037 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 15:19:18,043 - INFO - Found 3 emails in thread
2025-05-01 15:19:19,116 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 15:19:19,121 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 15:19:19,121 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:19,160 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 15:19:19,162 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:19,432 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 15:19:19,432 - INFO - Processed email: 19687342396240ae
2025-05-01 15:19:21,632 - INFO - GmailWatcher initialized
2025-05-01 17:44:38,314 - INFO - Vendor CSV path from .env: /path/to/your/vendor_emails.csv
2025-05-01 17:44:38,314 - ERROR - Vendor email CSV file not found at /path/to/your/vendor_emails.csv
2025-05-01 17:48:11,918 - INFO - Vendor CSV path from .env: /path/to/your/vendor_emails.csv
2025-05-01 17:48:11,919 - ERROR - Vendor email CSV file not found at /path/to/your/vendor_emails.csv
2025-05-01 17:49:35,302 - INFO - Vendor CSV path from .env: /path/to/your/vendor_emails.csv
2025-05-01 17:49:35,302 - ERROR - Vendor email CSV file not found at /path/to/your/vendor_emails.csv
2025-05-01 17:49:48,948 - INFO - Vendor CSV path from .env: /path/to/your/vendor_emails.csv
2025-05-01 17:49:48,949 - ERROR - Vendor email CSV file not found at /path/to/your/vendor_emails.csv
2025-05-01 17:53:36,108 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 17:53:36,279 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 17:53:36,281 - INFO - Loaded 2 vendor emails from database
2025-05-01 17:53:36,287 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 17:53:36,287 - INFO - Total unique vendor emails: 2
2025-05-01 17:53:36,287 - ERROR - Error in main: credentials.json file not found at c:\Users\USER\po_agent_os\Vendor_email_logger_agent\credentials\credentials.json
2025-05-01 17:54:14,022 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 17:54:14,557 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 17:54:14,564 - INFO - Loaded 2 vendor emails from database
2025-05-01 17:54:14,566 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 17:54:14,567 - INFO - Total unique vendor emails: 2
2025-05-01 17:54:20,785 - INFO - "GET /?state=uPEDD5KGJaoRLBztlKiIiXKuvk6ARA&code=4/0Ab_5qllOZXoSMJDQDeWgr0nTfRtSjqIllhp-ef6r9ymMEYDwjNo6xNysGNUWjgQyXrW9Kw&scope=https://mail.google.com/ HTTP/1.1" 200 65
2025-05-01 17:54:21,047 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 17:54:21,686 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 17:54:21,750 - INFO - Supabase client initialized successfully
2025-05-01 17:54:21,753 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 17:54:51,592 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:51,933 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:52,175 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:52,407 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:52,645 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:52,913 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:53,150 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:53,390 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:53,638 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:53,884 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:54,163 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:54,407 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:54,641 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:54,873 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:55,105 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:55,346 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:55,581 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:55,827 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:56,082 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:56,318 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:56,552 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:56,789 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:57,026 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:57,269 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:57,506 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:57,742 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:57,980 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:58,223 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:58,466 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:58,732 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:58,966 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:59,209 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:59,446 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:59,683 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:54:59,913 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:00,147 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:00,398 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:00,660 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:00,884 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:01,141 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:01,389 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:01,634 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:02,241 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:02,479 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:02,708 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:02,947 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:03,171 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:03,405 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:03,645 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:03,894 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:04,129 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:04,367 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:04,599 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:04,832 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:05,168 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:05,405 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:05,639 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:05,875 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:06,119 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:06,363 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:06,633 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:06,884 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:07,128 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:07,377 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:07,634 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:07,867 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:08,100 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:08,333 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:08,573 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:08,818 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:09,054 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:09,295 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:09,542 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:09,785 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:10,021 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:10,255 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:10,505 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:10,784 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:11,021 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:11,246 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:11,503 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:11,734 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:11,975 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:12,203 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:12,439 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:12,674 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:12,906 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:13,138 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:13,387 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:13,617 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:13,858 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:14,087 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:14,314 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:14,548 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:14,774 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:15,010 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:15,251 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:15,481 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:15,713 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:15,955 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:16,190 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:16,427 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:16,662 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:16,901 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:17,141 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:17,377 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:17,612 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:17,855 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:18,101 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:18,350 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:18,576 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:18,814 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:18,815 - INFO - GmailWatcher initialized
2025-05-01 17:55:19,330 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:19,581 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:19,822 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:20,065 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:20,304 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:55:20,557 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:21,066 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:21,305 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:21,538 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:21,784 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:22,033 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:56:22,282 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:22,811 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:23,050 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:23,567 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:24,100 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:24,629 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:57:24,876 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:25,376 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:25,611 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:25,852 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:26,097 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:26,345 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:58:26,601 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:27,111 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:27,350 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:27,657 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:27,897 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:28,152 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 17:59:28,394 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:28,896 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:29,134 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:29,393 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:29,640 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:29,883 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:00:30,130 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:30,660 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:30,896 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:31,137 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:31,680 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:31,920 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:01:32,166 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:32,693 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:32,934 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:33,200 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:33,449 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:33,704 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:33,945 - ERROR - Error checking vendor email: name 'vendor_manager' is not defined
2025-05-01 18:02:59,168 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 18:02:59,311 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 18:02:59,315 - INFO - Loaded 2 vendor emails from database
2025-05-01 18:02:59,317 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 18:02:59,317 - INFO - Total unique vendor emails: 2
2025-05-01 18:02:59,325 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 18:02:59,585 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 18:02:59,610 - INFO - Supabase client initialized successfully
2025-05-01 18:02:59,611 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 18:03:37,530 - INFO - Is vendor: True
2025-05-01 18:03:40,001 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:40,007 - INFO - Generated email type: purchase order review
2025-05-01 18:03:40,471 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:03:40,472 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:03:40,472 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 18:03:40,594 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:03:40,606 - INFO - Found 0 emails in thread
2025-05-01 18:03:41,726 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:41,728 - INFO - Parsed delivery date: None
2025-05-01 18:03:41,728 - INFO - Attempting to save email log: new po
2025-05-01 18:03:41,775 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:03:41,777 - INFO - Email saved successfully: new po
2025-05-01 18:03:42,081 - INFO - Message sent to MCP server: new po
2025-05-01 18:03:42,081 - INFO - Processed email: 1967aac700cf1999
2025-05-01 18:03:42,298 - INFO - Is vendor: True
2025-05-01 18:03:44,028 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:44,029 - INFO - Generated email type: delivery delay
2025-05-01 18:03:44,031 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 18:03:44,069 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:03:44,071 - INFO - Found 0 emails in thread
2025-05-01 18:03:45,154 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:45,155 - INFO - Parsed delivery date: None
2025-05-01 18:03:45,156 - INFO - Attempting to save email log: po status update
2025-05-01 18:03:45,216 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:03:45,217 - INFO - Email saved successfully: po status update
2025-05-01 18:03:45,221 - INFO - Message sent to MCP server: po status update
2025-05-01 18:03:45,221 - INFO - Processed email: 1967ab19c3293811
2025-05-01 18:03:46,418 - INFO - Is vendor: True
2025-05-01 18:03:49,147 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:49,155 - INFO - Generated email type: delivery confirmation
2025-05-01 18:03:49,157 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 18:03:49,194 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:03:49,196 - INFO - Found 0 emails in thread
2025-05-01 18:03:50,318 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:50,324 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:03:50,324 - INFO - Attempting to save email log: 
2025-05-01 18:03:50,380 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:03:50,381 - INFO - Email saved successfully: 
2025-05-01 18:03:50,641 - INFO - Message sent to MCP server: 
2025-05-01 18:03:50,643 - INFO - Processed email: 1967b271a1c91212
2025-05-01 18:03:50,882 - INFO - Is vendor: True
2025-05-01 18:03:53,140 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:53,144 - INFO - Generated email type: delivery confirmation
2025-05-01 18:03:53,144 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 18:03:53,274 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:03:53,278 - INFO - Found 0 emails in thread
2025-05-01 18:03:54,506 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:03:54,512 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:03:54,513 - INFO - Attempting to save email log: 
2025-05-01 18:03:54,666 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:03:54,667 - INFO - Email saved successfully: 
2025-05-01 18:03:54,930 - INFO - Message sent to MCP server: 
2025-05-01 18:03:54,930 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 18:04:03,430 - INFO - Is vendor: True
2025-05-01 18:04:05,873 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:05,880 - INFO - Generated email type: order confirmation
2025-05-01 18:04:05,881 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 18:04:05,977 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:05,980 - INFO - Found 0 emails in thread
2025-05-01 18:04:06,749 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:06,752 - INFO - Parsed delivery date: None
2025-05-01 18:04:06,752 - INFO - Attempting to save email log: 
2025-05-01 18:04:06,792 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:06,794 - INFO - Email saved successfully: 
2025-05-01 18:04:06,799 - ERROR - Error sending message to MCP server: [WinError 10053] 현재 연결은 사용자의 호스트 시스템의 소프트웨어의 의해 중단되었습니다
2025-05-01 18:04:06,801 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 18:04:07,252 - INFO - Is vendor: True
2025-05-01 18:04:09,530 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:09,533 - INFO - Generated email type: shipment scheduling
2025-05-01 18:04:09,533 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 18:04:09,573 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:09,575 - INFO - Found 0 emails in thread
2025-05-01 18:04:10,289 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:10,296 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:04:10,297 - INFO - Attempting to save email log: eta alert
2025-05-01 18:04:10,334 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:10,336 - INFO - Email saved successfully: eta alert
2025-05-01 18:04:10,609 - INFO - Message sent to MCP server: eta alert
2025-05-01 18:04:10,610 - INFO - Processed email: 19685655410ff470
2025-05-01 18:04:10,881 - INFO - Is vendor: True
2025-05-01 18:04:13,254 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:13,256 - INFO - Generated email type: delivery delay
2025-05-01 18:04:13,256 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 18:04:13,296 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:13,299 - INFO - Found 0 emails in thread
2025-05-01 18:04:14,394 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:14,398 - INFO - Parsed delivery date: None
2025-05-01 18:04:14,398 - INFO - Attempting to save email log: new eta for the latest po
2025-05-01 18:04:14,446 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:14,447 - INFO - Email saved successfully: new eta for the latest po
2025-05-01 18:04:14,453 - INFO - Message sent to MCP server: new eta for the latest po
2025-05-01 18:04:14,453 - INFO - Processed email: 196858d50560d69c
2025-05-01 18:04:14,691 - INFO - Is vendor: True
2025-05-01 18:04:18,285 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:18,291 - INFO - Generated email type: delivery delay
2025-05-01 18:04:18,292 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 18:04:19,253 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:19,260 - INFO - Found 0 emails in thread
2025-05-01 18:04:19,973 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:19,979 - INFO - Parsed delivery date: None
2025-05-01 18:04:19,980 - INFO - Attempting to save email log: delay alert for the latest po
2025-05-01 18:04:20,015 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:20,016 - INFO - Email saved successfully: delay alert for the latest po
2025-05-01 18:04:20,280 - INFO - Message sent to MCP server: delay alert for the latest po
2025-05-01 18:04:20,280 - INFO - Processed email: 196858fe40e734ea
2025-05-01 18:04:22,326 - INFO - Is vendor: True
2025-05-01 18:04:24,936 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:24,939 - INFO - Generated email type: purchase order
2025-05-01 18:04:25,361 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:04:25,362 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:04:25,364 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:04:25,470 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:25,474 - INFO - Found 4 emails in thread
2025-05-01 18:04:26,367 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:26,374 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:04:26,374 - INFO - Attempting to save email log: PO for 100ml cosmetic containers
2025-05-01 18:04:26,408 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:26,410 - INFO - Email saved successfully: PO for 100ml cosmetic containers
2025-05-01 18:04:26,681 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 18:04:26,682 - INFO - Processed email: 19687301aeba3f47
2025-05-01 18:04:27,144 - INFO - Is vendor: True
2025-05-01 18:04:29,813 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:29,815 - INFO - Generated email type: shipment confirmation
2025-05-01 18:04:29,816 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:04:29,859 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:29,862 - INFO - Found 5 emails in thread
2025-05-01 18:04:33,447 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:33,458 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:04:33,459 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:33,503 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:33,504 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:33,508 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:33,509 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 18:04:33,759 - INFO - Is vendor: True
2025-05-01 18:04:36,010 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:36,012 - INFO - Generated email type: delivery delay
2025-05-01 18:04:36,013 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:04:36,049 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:36,052 - INFO - Found 6 emails in thread
2025-05-01 18:04:37,120 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:37,125 - INFO - Parsed delivery date: 2023-05-10
2025-05-01 18:04:37,125 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:37,165 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:37,168 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:37,430 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:37,430 - INFO - Processed email: 196873410fd5bbde
2025-05-01 18:04:37,660 - INFO - Is vendor: True
2025-05-01 18:04:39,553 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:39,555 - INFO - Generated email type: shipment confirmation
2025-05-01 18:04:39,556 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:04:39,589 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:04:39,591 - INFO - Found 7 emails in thread
2025-05-01 18:04:40,687 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:04:40,690 - INFO - Parsed delivery date: 2025-05-07
2025-05-01 18:04:40,690 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:40,725 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:04:40,726 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:40,729 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:04:40,730 - INFO - Processed email: 19687342396240ae
2025-05-01 18:04:43,117 - INFO - GmailWatcher initialized
2025-05-01 18:19:00,263 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 633, in run_until_complete
    self.run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 600, in run_forever
    self._run_once()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1896, in _run_once
    handle._run()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\main.py", line 247, in main
    watcher.watch(lambda email: asyncio.create_task(process_email(service, email, email_processor, mcp_service, vendor_manager)))
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\src\gmail\gmail_watcher.py", line 76, in watch
    time.sleep(60)  # 60초마다 체크
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 현재 연결은 원격 호스트에 의해 강제로 끊겼습니다
2025-05-01 18:19:00,564 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000001A7CE397160>
2025-05-01 18:19:06,186 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 18:19:06,299 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 18:19:06,305 - INFO - Loaded 2 vendor emails from database
2025-05-01 18:19:06,307 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 18:19:06,307 - INFO - Total unique vendor emails: 2
2025-05-01 18:19:06,314 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 18:19:06,643 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 18:19:06,674 - INFO - Supabase client initialized successfully
2025-05-01 18:19:06,674 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 18:19:45,989 - INFO - Is vendor: True
2025-05-01 18:19:47,701 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:47,770 - INFO - Generated email type: purchase order review
2025-05-01 18:19:48,310 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:19:48,311 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:19:48,311 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 18:19:48,454 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:19:48,461 - INFO - Found 1 emails in thread
2025-05-01 18:19:49,585 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:49,588 - INFO - Parsed delivery date: None
2025-05-01 18:19:49,588 - INFO - Attempting to save email log: new po
2025-05-01 18:19:49,624 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:19:49,628 - INFO - Email saved successfully: new po
2025-05-01 18:19:49,903 - INFO - Message sent to MCP server: new po
2025-05-01 18:19:49,905 - INFO - Processed email: 1967aac700cf1999
2025-05-01 18:19:50,165 - INFO - Is vendor: True
2025-05-01 18:19:51,750 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:51,758 - INFO - Generated email type: delivery delay
2025-05-01 18:19:51,759 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 18:19:52,175 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:19:52,186 - INFO - Found 1 emails in thread
2025-05-01 18:19:53,209 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:53,219 - INFO - Parsed delivery date: None
2025-05-01 18:19:53,221 - INFO - Attempting to save email log: po status update
2025-05-01 18:19:53,264 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:19:53,271 - INFO - Email saved successfully: po status update
2025-05-01 18:19:53,290 - INFO - Message sent to MCP server: po status update
2025-05-01 18:19:53,292 - INFO - Processed email: 1967ab19c3293811
2025-05-01 18:19:54,531 - INFO - Is vendor: True
2025-05-01 18:19:56,523 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:56,532 - INFO - Generated email type: delivery confirmation
2025-05-01 18:19:56,535 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 18:19:56,573 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:19:56,578 - INFO - Found 1 emails in thread
2025-05-01 18:19:57,964 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:19:57,968 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:19:57,969 - INFO - Attempting to save email log: 
2025-05-01 18:19:58,005 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:19:58,007 - INFO - Email saved successfully: 
2025-05-01 18:19:58,282 - INFO - Message sent to MCP server: 
2025-05-01 18:19:58,285 - INFO - Processed email: 1967b271a1c91212
2025-05-01 18:19:58,554 - INFO - Is vendor: True
2025-05-01 18:20:00,546 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:00,554 - INFO - Generated email type: delivery confirmation
2025-05-01 18:20:00,556 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 18:20:00,604 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:00,609 - INFO - Found 1 emails in thread
2025-05-01 18:20:01,405 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:01,414 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:20:01,416 - INFO - Attempting to save email log: 
2025-05-01 18:20:01,454 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:01,459 - INFO - Email saved successfully: 
2025-05-01 18:20:01,741 - INFO - Message sent to MCP server: 
2025-05-01 18:20:01,742 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 18:20:10,600 - INFO - Is vendor: True
2025-05-01 18:20:12,718 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:12,725 - INFO - Generated email type: order confirmation
2025-05-01 18:20:12,726 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 18:20:12,845 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:12,853 - INFO - Found 1 emails in thread
2025-05-01 18:20:13,844 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:13,851 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:20:13,852 - INFO - Attempting to save email log: 
2025-05-01 18:20:13,911 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:13,915 - INFO - Email saved successfully: 
2025-05-01 18:20:14,200 - INFO - Message sent to MCP server: 
2025-05-01 18:20:14,202 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 18:20:14,753 - INFO - Is vendor: True
2025-05-01 18:20:16,747 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:16,750 - INFO - Generated email type: shipment scheduling
2025-05-01 18:20:16,750 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 18:20:16,786 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:16,788 - INFO - Found 1 emails in thread
2025-05-01 18:20:17,530 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:17,531 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:20:17,533 - INFO - Attempting to save email log: eta alert
2025-05-01 18:20:17,586 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:17,587 - INFO - Email saved successfully: eta alert
2025-05-01 18:20:17,590 - INFO - Message sent to MCP server: eta alert
2025-05-01 18:20:17,591 - INFO - Processed email: 19685655410ff470
2025-05-01 18:20:17,829 - INFO - Is vendor: True
2025-05-01 18:20:19,599 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:19,605 - INFO - Generated email type: delivery delay
2025-05-01 18:20:19,606 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 18:20:19,669 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:19,671 - INFO - Found 1 emails in thread
2025-05-01 18:20:20,362 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:20,367 - INFO - Parsed delivery date: None
2025-05-01 18:20:20,367 - INFO - Attempting to save email log: new eta for the latest po
2025-05-01 18:20:20,403 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:20,405 - INFO - Email saved successfully: new eta for the latest po
2025-05-01 18:20:20,672 - INFO - Message sent to MCP server: new eta for the latest po
2025-05-01 18:20:20,673 - INFO - Processed email: 196858d50560d69c
2025-05-01 18:20:20,903 - INFO - Is vendor: True
2025-05-01 18:20:22,584 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:22,586 - INFO - Generated email type: delivery delay
2025-05-01 18:20:22,586 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 18:20:22,632 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:22,634 - INFO - Found 1 emails in thread
2025-05-01 18:20:23,244 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:23,246 - INFO - Parsed delivery date: None
2025-05-01 18:20:23,247 - INFO - Attempting to save email log: delay alert for the latest po
2025-05-01 18:20:23,283 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:23,284 - INFO - Email saved successfully: delay alert for the latest po
2025-05-01 18:20:23,288 - INFO - Message sent to MCP server: delay alert for the latest po
2025-05-01 18:20:23,288 - INFO - Processed email: 196858fe40e734ea
2025-05-01 18:20:25,451 - INFO - Is vendor: True
2025-05-01 18:20:28,261 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:28,262 - INFO - Generated email type: purchase order confirmation
2025-05-01 18:20:28,685 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:20:28,685 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:20:28,686 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:20:28,773 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:28,775 - INFO - Found 8 emails in thread
2025-05-01 18:20:29,498 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:29,501 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:20:29,502 - INFO - Attempting to save email log: PO for 100ml cosmetic containers
2025-05-01 18:20:29,531 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:29,532 - INFO - Email saved successfully: PO for 100ml cosmetic containers
2025-05-01 18:20:29,797 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 18:20:29,797 - INFO - Processed email: 19687301aeba3f47
2025-05-01 18:20:30,256 - INFO - Is vendor: True
2025-05-01 18:20:32,639 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:32,642 - INFO - Generated email type: shipment confirmation
2025-05-01 18:20:32,643 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:20:32,671 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:32,673 - INFO - Found 9 emails in thread
2025-05-01 18:20:33,742 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:33,745 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:20:33,745 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:33,777 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:33,779 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:33,786 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:33,787 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 18:20:34,028 - INFO - Is vendor: True
2025-05-01 18:20:35,945 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:35,947 - INFO - Generated email type: delivery delay
2025-05-01 18:20:35,948 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:20:35,977 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:35,980 - INFO - Found 10 emails in thread
2025-05-01 18:20:36,767 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:36,769 - INFO - Parsed delivery date: 2023-05-10
2025-05-01 18:20:36,771 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:36,807 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:36,810 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:37,065 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:37,066 - INFO - Processed email: 196873410fd5bbde
2025-05-01 18:20:37,302 - INFO - Is vendor: True
2025-05-01 18:20:39,104 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:39,106 - INFO - Generated email type: shipment confirmation
2025-05-01 18:20:39,106 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:20:39,140 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:20:39,143 - INFO - Found 11 emails in thread
2025-05-01 18:20:39,853 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:20:39,855 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:20:39,855 - INFO - Attempting to save email log: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:39,883 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:20:39,884 - INFO - Email saved successfully: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:40,142 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:20:40,143 - INFO - Processed email: 19687342396240ae
2025-05-01 18:20:42,479 - INFO - GmailWatcher initialized
2025-05-01 18:27:05,299 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 633, in run_until_complete
    self.run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 600, in run_forever
    self._run_once()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1896, in _run_once
    handle._run()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\main.py", line 247, in main
    watcher.watch(lambda email: asyncio.create_task(process_email(service, email, email_processor, mcp_service, vendor_manager)))
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\src\gmail\gmail_watcher.py", line 76, in watch
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 현재 연결은 원격 호스트에 의해 강제로 끊겼습니다
2025-05-01 18:27:05,440 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x0000019F328C3130>
2025-05-01 18:32:32,515 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 18:32:33,012 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 18:32:33,015 - INFO - Loaded 2 vendor emails from database
2025-05-01 18:32:33,016 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 18:32:33,016 - INFO - Total unique vendor emails: 2
2025-05-01 18:32:33,022 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 18:32:33,240 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 18:32:33,265 - INFO - Supabase client initialized successfully
2025-05-01 18:32:33,266 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 18:33:11,822 - INFO - Is vendor: True
2025-05-01 18:33:13,678 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:13,687 - INFO - Generated email type: purchase order review
2025-05-01 18:33:14,251 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:14,253 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:33:14,255 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 18:33:14,390 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:14,395 - INFO - Found 1 emails in thread
2025-05-01 18:33:15,053 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:15,056 - INFO - Parsed delivery date: None
2025-05-01 18:33:15,099 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:15,100 - INFO - Update: Newer email for thread_id=1967aac700cf1999, updating row id=30
2025-05-01 18:33:15,139 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.30 "HTTP/1.1 200 OK"
2025-05-01 18:33:15,403 - INFO - Message sent to MCP server: new po
2025-05-01 18:33:15,404 - INFO - Processed email: 1967aac700cf1999
2025-05-01 18:33:15,633 - INFO - Is vendor: True
2025-05-01 18:33:17,307 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:17,315 - INFO - Generated email type: release delay
2025-05-01 18:33:17,315 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 18:33:17,350 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:17,352 - INFO - Found 1 emails in thread
2025-05-01 18:33:18,089 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:18,095 - INFO - Parsed delivery date: None
2025-05-01 18:33:18,146 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:18,148 - INFO - Update: Newer email for thread_id=1967ab19c3293811, updating row id=31
2025-05-01 18:33:18,185 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.31 "HTTP/1.1 200 OK"
2025-05-01 18:33:18,190 - INFO - Message sent to MCP server: po status update
2025-05-01 18:33:18,190 - INFO - Processed email: 1967ab19c3293811
2025-05-01 18:33:19,362 - INFO - Is vendor: True
2025-05-01 18:33:21,427 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:21,433 - INFO - Generated email type: delivery confirmation
2025-05-01 18:33:21,434 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 18:33:21,469 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:21,472 - INFO - Found 1 emails in thread
2025-05-01 18:33:22,382 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:22,386 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:33:22,463 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:22,465 - INFO - Update: Newer email for thread_id=1967b271a1c91212, updating row id=32
2025-05-01 18:33:22,500 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.32 "HTTP/1.1 200 OK"
2025-05-01 18:33:22,765 - INFO - Message sent to MCP server: 
2025-05-01 18:33:22,765 - INFO - Processed email: 1967b271a1c91212
2025-05-01 18:33:22,992 - INFO - Is vendor: True
2025-05-01 18:33:26,014 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:26,021 - INFO - Generated email type: delivery confirmation
2025-05-01 18:33:26,022 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 18:33:26,077 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:26,079 - INFO - Found 1 emails in thread
2025-05-01 18:33:26,848 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:26,851 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:33:26,983 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:26,986 - INFO - Update: Newer email for thread_id=1967b32b2f36808c, updating row id=33
2025-05-01 18:33:27,125 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.33 "HTTP/1.1 200 OK"
2025-05-01 18:33:27,396 - INFO - Message sent to MCP server: 
2025-05-01 18:33:27,396 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 18:33:35,917 - INFO - Is vendor: True
2025-05-01 18:33:38,395 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:38,398 - INFO - Generated email type: order confirmation
2025-05-01 18:33:38,398 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 18:33:38,520 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:38,523 - INFO - Found 0 emails in thread
2025-05-01 18:33:39,371 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:39,373 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:33:39,414 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:39,417 - INFO - Insert: New email log for thread_id=1968507ce2f9fef8
2025-05-01 18:33:39,448 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:39,449 - ERROR - Supabase insert/update error: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:39,450 - ERROR - Error type: APIError
2025-05-01 18:33:39,451 - ERROR - Email data: {'thread_id': '1968507ce2f9fef8', 'direction': 'outbound', 'sender_email': 'zach@shiftsai.com', 'recipient_email': '', 'subject': '', 'sent_at': 'Tue, 29 Apr 2025 21:50:03 -0700', 'created_at': '2025-05-01T09:33:36.470010', 'updated_at': '2025-05-01T09:33:36.470010', 'received_at': None, 'draft_body': None, 'status': 'sent', 'email_type': 'order confirmation', 'has_attachment': False, 'filename': None, 'attachment_types': [], 'summary': 'The email requests the vendor to confirm receipt of a purchase order for laptops and monitors, and to contact the sender if there are any questions or concerns.', 'sender_role': 'admin', 'parsed_delivery_date': '2025-05-01', 'trigger_reason': None, 'body': "Dear Test Vendor,\n\nWe are pleased to submit our Purchase Order PO-TEST-20250430044536 dated 2025-05-01.\n\nOrder Details:\n- LAP001: Dell XPS 13 Laptop, 16GB RAM, 512GB SSD\n  Quantity: 2, Unit Price: USD 1299.99, Total: USD 2934.98\n- MON002: Dell 27-inch 4K Monitor, USB-C Hub\n  Quantity: 2, Unit Price: USD 499.99, Total: USD 1174.98\n\nTotal Order Amount: USD 4109.96\n\nPlease review the order details and confirm receipt of this purchase order. If you have any questions or concerns, please don't hesitate to contact us.\n\nBest regards,\nProcurement Team"}
2025-05-01 18:33:39,451 - ERROR - Error saving email log: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:39,452 - ERROR - Error type: APIError
2025-05-01 18:33:39,720 - INFO - Message sent to MCP server: 
2025-05-01 18:33:39,720 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 18:33:40,199 - INFO - Is vendor: True
2025-05-01 18:33:42,117 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:42,124 - INFO - Generated email type: shipment scheduling
2025-05-01 18:33:42,125 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 18:33:42,163 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:42,165 - INFO - Found 0 emails in thread
2025-05-01 18:33:42,928 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:42,930 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:33:42,968 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:42,970 - INFO - Insert: New email log for thread_id=19685655410ff470
2025-05-01 18:33:43,009 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:43,009 - ERROR - Supabase insert/update error: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:43,011 - ERROR - Error type: APIError
2025-05-01 18:33:43,011 - ERROR - Email data: {'thread_id': '19685655410ff470', 'direction': 'inbound', 'sender_email': '"박성호" <mario904@snu.ac.kr>', 'recipient_email': 'zach@shiftsai.com', 'subject': 'eta alert', 'sent_at': None, 'created_at': '2025-05-01T09:33:40.657358', 'updated_at': '2025-05-01T09:33:40.657358', 'received_at': 'Wed, 30 Apr 2025 15:32:01 +0900', 'draft_body': None, 'status': 'received', 'email_type': 'shipment scheduling', 'has_attachment': False, 'filename': None, 'attachment_types': [], 'summary': 'Purchase Order PO-20250413-001 is scheduled to be shipped on May 7th, but the shipping date is subject to change.', 'sender_role': 'vendor', 'parsed_delivery_date': '2023-05-07', 'trigger_reason': None, 'body': "PO-20250413-001's will be shipped on May 7th. But it can be changed.\r\n"}
2025-05-01 18:33:43,011 - ERROR - Error saving email log: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:43,012 - ERROR - Error type: APIError
2025-05-01 18:33:43,014 - INFO - Message sent to MCP server: eta alert
2025-05-01 18:33:43,015 - INFO - Processed email: 19685655410ff470
2025-05-01 18:33:43,249 - INFO - Is vendor: True
2025-05-01 18:33:45,174 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:45,182 - INFO - Generated email type: delivery delay
2025-05-01 18:33:45,184 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 18:33:45,245 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:45,253 - INFO - Found 0 emails in thread
2025-05-01 18:33:46,072 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:46,078 - INFO - Parsed delivery date: None
2025-05-01 18:33:46,126 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:46,127 - INFO - Insert: New email log for thread_id=196858d50560d69c
2025-05-01 18:33:46,165 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:46,166 - ERROR - Supabase insert/update error: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:46,166 - ERROR - Error type: APIError
2025-05-01 18:33:46,168 - ERROR - Email data: {'thread_id': '196858d50560d69c', 'direction': 'inbound', 'sender_email': '"박성호" <mario904@snu.ac.kr>', 'recipient_email': 'zach@shiftsai.com', 'subject': 'new eta for the latest po', 'sent_at': None, 'created_at': '2025-05-01T09:33:43.728750', 'updated_at': '2025-05-01T09:33:43.728750', 'received_at': 'Wed, 30 Apr 2025 16:15:42 +0900', 'draft_body': None, 'status': 'received', 'email_type': 'delivery delay', 'has_attachment': False, 'filename': None, 'attachment_types': [], 'summary': 'The estimated time of arrival for purchase order PO-20250413-001 has been delayed by an additional two days.', 'sender_role': 'vendor', 'parsed_delivery_date': None, 'trigger_reason': None, 'body': "Sorry to tell you.\r\nPO-20250413-001's eta is delayed for another 2 days.\r\n"}
2025-05-01 18:33:46,168 - ERROR - Error saving email log: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:46,169 - ERROR - Error type: APIError
2025-05-01 18:33:46,428 - INFO - Message sent to MCP server: new eta for the latest po
2025-05-01 18:33:46,430 - INFO - Processed email: 196858d50560d69c
2025-05-01 18:33:46,677 - INFO - Is vendor: True
2025-05-01 18:33:48,241 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:48,244 - INFO - Generated email type: delivery delay
2025-05-01 18:33:48,246 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 18:33:48,288 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:48,289 - INFO - Found 0 emails in thread
2025-05-01 18:33:48,938 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:48,943 - INFO - Parsed delivery date: None
2025-05-01 18:33:48,985 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:48,987 - INFO - Insert: New email log for thread_id=196858fe40e734ea
2025-05-01 18:33:49,035 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:49,037 - ERROR - Supabase insert/update error: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:49,037 - ERROR - Error type: APIError
2025-05-01 18:33:49,038 - ERROR - Email data: {'thread_id': '196858fe40e734ea', 'direction': 'inbound', 'sender_email': '"박성호" <mario904@snu.ac.kr>', 'recipient_email': 'zach@shiftsai.com', 'subject': 'delay alert for the latest po', 'sent_at': None, 'created_at': '2025-05-01T09:33:47.134886', 'updated_at': '2025-05-01T09:33:47.134886', 'received_at': 'Wed, 30 Apr 2025 16:18:30 +0900', 'draft_body': None, 'status': 'received', 'email_type': 'delivery delay', 'has_attachment': False, 'filename': None, 'attachment_types': [], 'summary': 'The latest purchase order will be delayed by an additional three days.', 'sender_role': 'vendor', 'parsed_delivery_date': None, 'trigger_reason': None, 'body': 'the latest po will be delayed for another 3 days.\r\n'}
2025-05-01 18:33:49,038 - ERROR - Error saving email log: {'code': 'PGRST204', 'details': None, 'hint': None, 'message': "Could not find the 'message_id' column of 'email_logs' in the schema cache"}
2025-05-01 18:33:49,039 - ERROR - Error type: APIError
2025-05-01 18:33:49,044 - INFO - Message sent to MCP server: delay alert for the latest po
2025-05-01 18:33:49,045 - INFO - Processed email: 196858fe40e734ea
2025-05-01 18:33:51,130 - INFO - Is vendor: True
2025-05-01 18:33:53,298 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:53,332 - INFO - Generated email type: purchase order confirmation
2025-05-01 18:33:53,759 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:33:53,760 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:33:53,761 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:33:53,798 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:53,799 - INFO - Found 4 emails in thread
2025-05-01 18:33:54,463 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:54,465 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:33:54,510 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:54,511 - INFO - Update: Newer email for thread_id=196872f923934e74, updating row id=26
2025-05-01 18:33:54,555 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.26 "HTTP/1.1 200 OK"
2025-05-01 18:33:54,826 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 18:33:54,826 - INFO - Processed email: 19687301aeba3f47
2025-05-01 18:33:55,321 - INFO - Is vendor: True
2025-05-01 18:33:58,408 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:58,411 - INFO - Generated email type: order confirmation
2025-05-01 18:33:58,411 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:33:58,453 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:33:58,455 - INFO - Found 4 emails in thread
2025-05-01 18:33:59,123 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:33:59,126 - INFO - Parsed delivery date: 2023-05-08
2025-05-01 18:33:59,160 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:33:59,161 - INFO - Update: Newer email for thread_id=196872f923934e74, updating row id=29
2025-05-01 18:33:59,203 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.29 "HTTP/1.1 200 OK"
2025-05-01 18:33:59,211 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:33:59,211 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 18:33:59,440 - INFO - Is vendor: True
2025-05-01 18:34:01,378 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:34:01,380 - INFO - Generated email type: delivery delay
2025-05-01 18:34:01,380 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:34:01,428 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:34:01,430 - INFO - Found 4 emails in thread
2025-05-01 18:34:02,276 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:34:02,278 - INFO - Parsed delivery date: 2023-05-10
2025-05-01 18:34:02,341 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:34:02,342 - INFO - Update: Newer email for thread_id=196872f923934e74, updating row id=26
2025-05-01 18:34:02,379 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.26 "HTTP/1.1 200 OK"
2025-05-01 18:34:02,646 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:34:02,648 - INFO - Processed email: 196873410fd5bbde
2025-05-01 18:34:02,883 - INFO - Is vendor: True
2025-05-01 18:34:05,259 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:34:05,267 - INFO - Generated email type: shipment confirmation
2025-05-01 18:34:05,268 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:34:05,316 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:34:05,319 - INFO - Found 4 emails in thread
2025-05-01 18:34:06,049 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:34:06,051 - INFO - Parsed delivery date: 2023-05-10
2025-05-01 18:34:06,090 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=received_at.desc&limit=1 "HTTP/1.1 200 OK"
2025-05-01 18:34:06,092 - INFO - Update: Newer email for thread_id=196872f923934e74, updating row id=28
2025-05-01 18:34:06,135 - INFO - HTTP Request: PATCH https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?id=eq.28 "HTTP/1.1 200 OK"
2025-05-01 18:34:06,405 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:34:06,407 - INFO - Processed email: 19687342396240ae
2025-05-01 18:34:08,731 - INFO - GmailWatcher initialized
2025-05-01 18:50:38,844 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 633, in run_until_complete
    self.run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\windows_events.py", line 321, in run_forever
    super().run_forever()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 600, in run_forever
    self._run_once()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\base_events.py", line 1896, in _run_once
    handle._run()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\main.py", line 247, in main
    logger.info("GmailWatcher initialized")
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\src\gmail\gmail_watcher.py", line 72, in watch
    new_emails = self.get_new_emails()
  File "c:\Users\USER\po_agent_os\Vendor_email_logger_agent\src\gmail\gmail_watcher.py", line 46, in get_new_emails
    ).execute()
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\googleapiclient\_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\googleapiclient\http.py", line 923, in execute
    resp, content = _retry_request(
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\googleapiclient\http.py", line 191, in _retry_request
    resp, content = http.request(uri, method, *args, **kwargs)
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\google_auth_httplib2.py", line 218, in request
    response, content = self.http.request(
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\httplib2\__init__.py", line 1724, in request
    (response, content) = self._request(
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\httplib2\__init__.py", line 1444, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "C:\Users\USER\po_agent_os\.venv\lib\site-packages\httplib2\__init__.py", line 1396, in _conn_request
    response = conn.getresponse()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\http\client.py", line 1374, in getresponse
    response.begin()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\ssl.py", line 1274, in recv_into
    return self.read(nbytes, buffer)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\ssl.py", line 1130, in read
    return self._sslobj.read(len, buffer)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\USER\AppData\Local\Programs\Python\Python310\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 현재 연결은 원격 호스트에 의해 강제로 끊겼습니다
2025-05-01 18:50:40,175 - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002A9AF9B13C0>
2025-05-01 18:55:45,464 - INFO - Vendor CSV path from .env: C:\Users\USER\po_agent_os\mock_vendor_emails.csv
2025-05-01 18:55:45,624 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 18:55:45,636 - INFO - Loaded 2 vendor emails from database
2025-05-01 18:55:45,640 - INFO - Loaded 0 additional vendor emails from CSV
2025-05-01 18:55:45,641 - INFO - Total unique vendor emails: 2
2025-05-01 18:55:45,656 - INFO - file_cache is only supported with oauth2client<4.0.0
2025-05-01 18:55:45,844 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 18:55:45,866 - INFO - Supabase client initialized successfully
2025-05-01 18:55:45,867 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 18:56:24,111 - INFO - Is vendor: True
2025-05-01 18:56:25,851 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:25,857 - INFO - Generated email type: purchase order review
2025-05-01 18:56:26,340 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:56:26,341 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:56:26,341 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 18:56:26,459 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:26,469 - INFO - Found 0 emails in thread
2025-05-01 18:56:27,074 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:27,076 - INFO - Parsed delivery date: None
2025-05-01 18:56:27,112 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967aac700cf1999&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:27,112 - INFO - Insert: New email log for thread_id=1967aac700cf1999, message_id=None
2025-05-01 18:56:27,153 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:27,418 - INFO - Message sent to MCP server: new po
2025-05-01 18:56:27,419 - INFO - Processed email: 1967aac700cf1999
2025-05-01 18:56:27,643 - INFO - Is vendor: True
2025-05-01 18:56:29,340 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:29,348 - INFO - Generated email type: delivery delay
2025-05-01 18:56:29,349 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 18:56:29,387 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:29,389 - INFO - Found 0 emails in thread
2025-05-01 18:56:30,087 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:30,090 - INFO - Parsed delivery date: None
2025-05-01 18:56:30,133 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967ab19c3293811&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:30,133 - INFO - Insert: New email log for thread_id=1967ab19c3293811, message_id=None
2025-05-01 18:56:30,167 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:30,172 - INFO - Message sent to MCP server: po status update
2025-05-01 18:56:30,172 - INFO - Processed email: 1967ab19c3293811
2025-05-01 18:56:31,341 - INFO - Is vendor: True
2025-05-01 18:56:33,500 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:33,503 - INFO - Generated email type: delivery confirmation
2025-05-01 18:56:33,503 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 18:56:33,541 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:33,545 - INFO - Found 0 emails in thread
2025-05-01 18:56:34,456 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:34,458 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:56:34,489 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967b271a1c91212&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:34,491 - INFO - Insert: New email log for thread_id=1967b271a1c91212, message_id=None
2025-05-01 18:56:34,621 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:34,888 - INFO - Message sent to MCP server: 
2025-05-01 18:56:34,889 - INFO - Processed email: 1967b271a1c91212
2025-05-01 18:56:35,236 - INFO - Is vendor: True
2025-05-01 18:56:37,313 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:37,319 - INFO - Generated email type: delivery confirmation
2025-05-01 18:56:37,319 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 18:56:37,869 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:37,871 - INFO - Found 0 emails in thread
2025-05-01 18:56:38,653 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:38,658 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:56:38,700 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967b32b2f36808c&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:38,701 - INFO - Insert: New email log for thread_id=1967b32b2f36808c, message_id=None
2025-05-01 18:56:38,738 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:38,997 - INFO - Message sent to MCP server: 
2025-05-01 18:56:38,998 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 18:56:47,543 - INFO - Is vendor: True
2025-05-01 18:56:49,788 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:49,795 - INFO - Generated email type: order confirmation
2025-05-01 18:56:49,795 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 18:56:49,877 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:49,881 - INFO - Found 0 emails in thread
2025-05-01 18:56:50,982 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:50,984 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:56:51,026 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1968507ce2f9fef8&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:51,029 - INFO - Insert: New email log for thread_id=1968507ce2f9fef8, message_id=None
2025-05-01 18:56:51,071 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:51,343 - INFO - Message sent to MCP server: 
2025-05-01 18:56:51,344 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 18:56:51,810 - INFO - Is vendor: True
2025-05-01 18:56:53,820 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:53,821 - INFO - Generated email type: shipment scheduling
2025-05-01 18:56:53,823 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 18:56:53,868 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:53,870 - INFO - Found 0 emails in thread
2025-05-01 18:56:54,676 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:54,698 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:56:54,737 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.19685655410ff470&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:54,739 - INFO - Insert: New email log for thread_id=19685655410ff470, message_id=None
2025-05-01 18:56:54,768 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:54,772 - INFO - Message sent to MCP server: eta alert
2025-05-01 18:56:54,773 - INFO - Processed email: 19685655410ff470
2025-05-01 18:56:55,004 - INFO - Is vendor: True
2025-05-01 18:56:56,739 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:56,742 - INFO - Generated email type: delivery delay
2025-05-01 18:56:56,743 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 18:56:56,772 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:56:56,775 - INFO - Found 0 emails in thread
2025-05-01 18:56:57,530 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:57,532 - INFO - Parsed delivery date: None
2025-05-01 18:56:57,558 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196858d50560d69c&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:56:57,559 - INFO - Insert: New email log for thread_id=196858d50560d69c, message_id=None
2025-05-01 18:56:57,600 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:56:57,861 - INFO - Message sent to MCP server: new eta for the latest po
2025-05-01 18:56:57,861 - INFO - Processed email: 196858d50560d69c
2025-05-01 18:56:58,095 - INFO - Is vendor: True
2025-05-01 18:56:59,974 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:56:59,976 - INFO - Generated email type: delivery delay
2025-05-01 18:56:59,977 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 18:57:00,007 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:57:00,008 - INFO - Found 0 emails in thread
2025-05-01 18:57:01,082 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:01,084 - INFO - Parsed delivery date: None
2025-05-01 18:57:01,115 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196858fe40e734ea&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:57:01,116 - INFO - Insert: New email log for thread_id=196858fe40e734ea, message_id=None
2025-05-01 18:57:01,159 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:57:01,420 - INFO - Message sent to MCP server: delay alert for the latest po
2025-05-01 18:57:01,421 - INFO - Processed email: 196858fe40e734ea
2025-05-01 18:57:03,523 - INFO - Is vendor: True
2025-05-01 18:57:05,649 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:05,654 - INFO - Generated email type: purchase order
2025-05-01 18:57:06,080 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:57:06,081 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:57:06,082 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:57:06,118 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:57:06,124 - INFO - Found 0 emails in thread
2025-05-01 18:57:06,864 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:06,867 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:57:06,897 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:57:06,898 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:57:06,925 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:57:06,929 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 18:57:06,929 - INFO - Processed email: 19687301aeba3f47
2025-05-01 18:57:07,403 - INFO - Is vendor: True
2025-05-01 18:57:09,413 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:09,415 - INFO - Generated email type: shipment confirmation
2025-05-01 18:57:09,415 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:57:09,443 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:57:09,445 - INFO - Found 1 emails in thread
2025-05-01 18:57:10,549 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:10,555 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:57:10,581 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:57:10,583 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:57:10,625 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:57:10,900 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:57:10,901 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 18:57:11,139 - INFO - Is vendor: True
2025-05-01 18:57:13,166 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:13,173 - INFO - Generated email type: delivery delay
2025-05-01 18:57:13,174 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:57:13,204 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:57:13,208 - INFO - Found 2 emails in thread
2025-05-01 18:57:14,006 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:14,010 - INFO - Parsed delivery date: 2023-05-09
2025-05-01 18:57:14,034 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:57:14,036 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:57:14,063 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:57:14,340 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:57:14,342 - INFO - Processed email: 196873410fd5bbde
2025-05-01 18:57:14,597 - INFO - Is vendor: True
2025-05-01 18:57:16,763 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:16,765 - INFO - Generated email type: shipment confirmation
2025-05-01 18:57:16,765 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:57:16,804 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:57:16,805 - INFO - Found 3 emails in thread
2025-05-01 18:57:18,282 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:18,287 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:57:18,317 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:57:18,320 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:57:18,352 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:57:18,364 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:57:18,366 - INFO - Processed email: 19687342396240ae
2025-05-01 18:57:21,052 - INFO - GmailWatcher initialized
2025-05-01 18:57:21,053 - INFO - Searching emails with query: after:2025/04/01
2025-05-01 18:57:58,341 - INFO - Is vendor: True
2025-05-01 18:57:59,849 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:57:59,853 - INFO - Generated email type: purchase order review
2025-05-01 18:58:00,305 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:58:00,308 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:58:00,310 - INFO - Fetching thread history for thread_id: 1967aac700cf1999
2025-05-01 18:58:00,418 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967aac700cf1999&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:00,425 - INFO - Found 1 emails in thread
2025-05-01 18:58:01,467 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:01,471 - INFO - Parsed delivery date: None
2025-05-01 18:58:01,520 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967aac700cf1999&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:01,521 - INFO - Insert: New email log for thread_id=1967aac700cf1999, message_id=None
2025-05-01 18:58:01,558 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:01,562 - INFO - Initializing Supabase client with URL: https://ujvbinqvvgbzgwqluian.supabase.co
2025-05-01 18:58:01,612 - INFO - Supabase client initialized successfully
2025-05-01 18:58:01,701 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 18:58:01,974 - INFO - Message sent to MCP server: new po
2025-05-01 18:58:01,975 - INFO - Processed email: 1967aac700cf1999
2025-05-01 18:58:02,588 - INFO - Is vendor: True
2025-05-01 18:58:05,323 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:05,331 - INFO - Generated email type: delivery delay
2025-05-01 18:58:05,332 - INFO - Fetching thread history for thread_id: 1967ab19c3293811
2025-05-01 18:58:05,373 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967ab19c3293811&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:05,374 - INFO - Found 1 emails in thread
2025-05-01 18:58:05,987 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:05,989 - INFO - Parsed delivery date: None
2025-05-01 18:58:06,039 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967ab19c3293811&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:06,040 - INFO - Insert: New email log for thread_id=1967ab19c3293811, message_id=None
2025-05-01 18:58:06,076 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:06,088 - INFO - Message sent to MCP server: po status update
2025-05-01 18:58:06,090 - INFO - Processed email: 1967ab19c3293811
2025-05-01 18:58:07,329 - INFO - Is vendor: True
2025-05-01 18:58:09,183 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:09,185 - INFO - Generated email type: delivery confirmation
2025-05-01 18:58:09,186 - INFO - Fetching thread history for thread_id: 1967b271a1c91212
2025-05-01 18:58:09,220 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b271a1c91212&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:09,222 - INFO - Found 1 emails in thread
2025-05-01 18:58:09,962 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:09,969 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:58:10,015 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967b271a1c91212&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:10,016 - INFO - Insert: New email log for thread_id=1967b271a1c91212, message_id=None
2025-05-01 18:58:10,051 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:10,317 - INFO - Message sent to MCP server: 
2025-05-01 18:58:10,318 - INFO - Processed email: 1967b271a1c91212
2025-05-01 18:58:10,547 - INFO - Is vendor: True
2025-05-01 18:58:12,466 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:12,474 - INFO - Generated email type: delivery confirmation
2025-05-01 18:58:12,475 - INFO - Fetching thread history for thread_id: 1967b32b2f36808c
2025-05-01 18:58:12,512 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1967b32b2f36808c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:12,514 - INFO - Found 1 emails in thread
2025-05-01 18:58:13,549 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:13,551 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:58:13,597 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1967b32b2f36808c&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:13,598 - INFO - Insert: New email log for thread_id=1967b32b2f36808c, message_id=None
2025-05-01 18:58:13,636 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:13,906 - INFO - Message sent to MCP server: 
2025-05-01 18:58:13,906 - INFO - Processed email: 1967b32b2f36808c
2025-05-01 18:58:22,489 - INFO - Is vendor: True
2025-05-01 18:58:24,330 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:24,332 - INFO - Generated email type: order confirmation
2025-05-01 18:58:24,332 - INFO - Fetching thread history for thread_id: 1968507ce2f9fef8
2025-05-01 18:58:24,786 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.1968507ce2f9fef8&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:24,787 - INFO - Found 1 emails in thread
2025-05-01 18:58:26,026 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:26,032 - INFO - Parsed delivery date: 2025-05-01
2025-05-01 18:58:26,071 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.1968507ce2f9fef8&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:26,073 - INFO - Insert: New email log for thread_id=1968507ce2f9fef8, message_id=None
2025-05-01 18:58:26,114 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:26,372 - INFO - Message sent to MCP server: 
2025-05-01 18:58:26,372 - INFO - Processed email: 1968507ce2f9fef8
2025-05-01 18:58:26,853 - INFO - Is vendor: True
2025-05-01 18:58:28,852 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:28,864 - INFO - Generated email type: shipment scheduling
2025-05-01 18:58:28,865 - INFO - Fetching thread history for thread_id: 19685655410ff470
2025-05-01 18:58:28,918 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.19685655410ff470&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:28,919 - INFO - Found 1 emails in thread
2025-05-01 18:58:29,675 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:29,677 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:58:29,723 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.19685655410ff470&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:29,724 - INFO - Insert: New email log for thread_id=19685655410ff470, message_id=None
2025-05-01 18:58:29,776 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:29,780 - INFO - Message sent to MCP server: eta alert
2025-05-01 18:58:29,780 - INFO - Processed email: 19685655410ff470
2025-05-01 18:58:30,013 - INFO - Is vendor: True
2025-05-01 18:58:32,002 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:32,013 - INFO - Generated email type: delivery delay
2025-05-01 18:58:32,014 - INFO - Fetching thread history for thread_id: 196858d50560d69c
2025-05-01 18:58:32,068 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858d50560d69c&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:32,069 - INFO - Found 1 emails in thread
2025-05-01 18:58:32,742 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:32,749 - INFO - Parsed delivery date: None
2025-05-01 18:58:32,787 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196858d50560d69c&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:32,792 - INFO - Insert: New email log for thread_id=196858d50560d69c, message_id=None
2025-05-01 18:58:32,834 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:33,108 - INFO - Message sent to MCP server: new eta for the latest po
2025-05-01 18:58:33,108 - INFO - Processed email: 196858d50560d69c
2025-05-01 18:58:33,338 - INFO - Is vendor: True
2025-05-01 18:58:34,889 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:34,893 - INFO - Generated email type: delivery delay
2025-05-01 18:58:34,894 - INFO - Fetching thread history for thread_id: 196858fe40e734ea
2025-05-01 18:58:34,934 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196858fe40e734ea&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:34,938 - INFO - Found 1 emails in thread
2025-05-01 18:58:35,840 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:35,853 - INFO - Parsed delivery date: None
2025-05-01 18:58:35,922 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196858fe40e734ea&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:35,924 - INFO - Insert: New email log for thread_id=196858fe40e734ea, message_id=None
2025-05-01 18:58:35,955 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:35,958 - INFO - Message sent to MCP server: delay alert for the latest po
2025-05-01 18:58:35,959 - INFO - Processed email: 196858fe40e734ea
2025-05-01 18:58:38,050 - INFO - Is vendor: True
2025-05-01 18:58:40,334 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:40,341 - INFO - Generated email type: purchase order
2025-05-01 18:58:40,770 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/storage/v1/object/attachments-from-vendor//None "HTTP/1.1 400 Bad Request"
2025-05-01 18:58:40,773 - ERROR - Error downloading attachment: {'statusCode': 400, 'error': 'Duplicate', 'message': 'The resource already exists'}
2025-05-01 18:58:40,773 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:58:40,811 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:40,812 - INFO - Found 4 emails in thread
2025-05-01 18:58:41,528 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:41,531 - INFO - Parsed delivery date: 2023-05-09
2025-05-01 18:58:41,566 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:41,568 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:58:41,607 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:41,871 - INFO - Message sent to MCP server: PO for 100ml cosmetic containers
2025-05-01 18:58:41,872 - INFO - Processed email: 19687301aeba3f47
2025-05-01 18:58:42,342 - INFO - Is vendor: True
2025-05-01 18:58:45,679 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:45,683 - INFO - Generated email type: shipment confirmation
2025-05-01 18:58:45,684 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:58:45,724 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:45,728 - INFO - Found 5 emails in thread
2025-05-01 18:58:46,530 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:46,535 - INFO - Parsed delivery date: 2023-05-09
2025-05-01 18:58:46,570 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:46,572 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:58:46,615 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:46,619 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:58:46,620 - INFO - Processed email: 1968733cd67bc06f
2025-05-01 18:58:46,850 - INFO - Is vendor: True
2025-05-01 18:58:49,193 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:49,203 - INFO - Generated email type: delivery delay
2025-05-01 18:58:49,204 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:58:49,243 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:49,245 - INFO - Found 6 emails in thread
2025-05-01 18:58:50,252 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:50,281 - INFO - Parsed delivery date: 2023-05-11
2025-05-01 18:58:50,312 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:50,313 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:58:50,354 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:50,614 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:58:50,615 - INFO - Processed email: 196873410fd5bbde
2025-05-01 18:58:50,880 - INFO - Is vendor: True
2025-05-01 18:58:52,864 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:52,865 - INFO - Generated email type: shipment confirmation
2025-05-01 18:58:52,865 - INFO - Fetching thread history for thread_id: 196872f923934e74
2025-05-01 18:58:52,925 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=%2A&thread_id=eq.196872f923934e74&order=sent_at "HTTP/1.1 200 OK"
2025-05-01 18:58:52,926 - INFO - Found 7 emails in thread
2025-05-01 18:58:53,616 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 18:58:53,618 - INFO - Parsed delivery date: 2023-05-07
2025-05-01 18:58:53,674 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs?select=id&thread_id=eq.196872f923934e74&message_id=eq.None "HTTP/1.1 200 OK"
2025-05-01 18:58:53,676 - INFO - Insert: New email log for thread_id=196872f923934e74, message_id=None
2025-05-01 18:58:53,709 - INFO - HTTP Request: POST https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/email_logs "HTTP/1.1 201 Created"
2025-05-01 18:58:53,978 - INFO - Message sent to MCP server: Re: PO for 100ml cosmetic containers
2025-05-01 18:58:53,978 - INFO - Processed email: 19687342396240ae
2025-05-01 19:08:02,276 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 19:18:02,789 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 19:54:17,958 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:04:18,089 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:14:18,484 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:25:17,857 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:35:18,343 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:45:19,263 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 20:55:19,795 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 21:05:20,318 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 21:15:20,433 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 21:25:20,594 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-01 21:35:20,684 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 07:54:50,785 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 08:04:50,871 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 10:28:00,993 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 10:38:01,099 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 10:48:01,325 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 10:58:01,403 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:08:01,501 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:18:01,883 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:28:02,124 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:38:02,210 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:48:02,323 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 11:58:02,417 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 12:08:02,552 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 12:18:02,672 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 12:28:02,794 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 12:38:02,880 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
2025-05-02 12:48:02,986 - INFO - HTTP Request: GET https://ujvbinqvvgbzgwqluian.supabase.co/rest/v1/purchase_orders?select=vendor_email&vendor_email=not.is.null "HTTP/1.1 200 OK"
